-- 물고기 종류 별 대어 찾기
SELECT A.ID, B.FISH_NAME, MAX(A.LENGTH) AS LENGTH
FROM FISH_INFO A
  JOIN FISH_NAME_INFO B ON A.FISH_TYPE = B.FISH_TYPE
GROUP BY B.FISH_TYPE 
ORDER BY A.ID
-- 셀렉절에 있는 모든 컬럼은 집계함수이거나 그룹바이절에 사용되어야함.
-- 따라서 위처럼 단순하게 MAX 사용하면 오류가 남.

-- 서브쿼리를 이용
SELECT A.ID, B.FISH_NAME, A.LENGTH
FROM FISH_INFO A
  JOIN FISH_NAME_INFO B ON A.FISH_TYPE = B.FISH_TYPE
WHERE (A.FISH_TYPE, A.LENGTH) IN
(
  SELECT FISH_TYPE, MAX(LENGTH)
  FROM FISH_INFO
  GROUP BY FISH_TYPE
)
ORDER BY A.ID